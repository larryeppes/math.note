# 笛卡尔符号法则(Descartes' Rule of Signs)[^1]

实系数多项式方程正根的个数等于系数的变号次数减去一个非负偶数. 

> 变号次数的含义: 对于 $n$ 次实系数多项式 $f(x)=a_{0} x^{n}+a_{1} x^{n-1}+\cdots+a_{n-1} x+a_{n}$, $a_{0} \neq 0$, 忽略系数为0的项, 相邻系数符号相反, 称为 1 次变号, 变号的总次数称为多项式系数的变号次数, 记为 $V(f)$.

> 我们从最简单的实系数一元一次方程 $a_{0} x+a_{1}=0$, $a_{0} \neq 0$ 开始. 方程有唯一根 $x=-\frac{a_{1}}{a_{0}}$, 当 $a_{0}$ 和 $a_{1}$ 符号不同时, 变号次数为 1 次, 有1个正根; 而当符号相同时, 有1个负根, 当 $a_{1}=0$ 时, 根为 0, 都对应变号次数为 0, 有0个正根. 

> 实系数一元二次方程 $a_{0} x^{2}+a_{1} x+a_{2}=0$, $a_{0} \neq 0$, 两根之和 $x_{1}+x_{2}=-\frac{a_{1}}{a_{0}}$, 两根之积 $x_{1} x_{2}=\frac{a_{2}}{a_{0}}$. 不妨假设 $a_{0}>0$, 记 $\Delta=a_{1}^{2}-4 a_{0} a_{2}$ 为方程的判别式. 
>
> > 情形1: $a_{1}<0, a_{2}>0$, 两根之和, 两根之积均为正, 对应有2个正根 $(\Delta \geq 0)$ 或2个共轭虚根 $(\Delta<0)$, 此时多项式系数变号次数为 2, 有2个或0个正根; 
> >
> > 情况2: $a_{1}<0, a_{2}<0$, 两根之和为正, 两根之积为负, 且一定有 $\Delta>0$, 对应有1正1负两个实根, 此时多项式变号次数为 1, 有 1 个正根; 
> >
> > 情形3: $a_{1}>0, a_{2}<0$, 两根之和, 两根之积均为负, 且一定有 $\Delta>0$, 对应有1正1负两个实根, 此时多项式变号次数为 1, 有 1 个正根; 
> >
> > 情形4: $a_{1}>0, a_{2}>0$, 两根之和为负, 两根之积为正, 对应有2个负根 ($\Delta \geq 0$)  或2个共轭虚根 $(\Delta<0)$, 此时多项式变号次数为0, 有0个正根; 
> >
> > 情形5: $a_{1}=0, a_{2}<0$,  1正1负两个实根, 变号次数为1, 有1个正根; 
> >
> > 情形6: $a_{1}=0, a_{2}>0$,  2个共轭虚根, 变号次数为0, 有0个正根; 
> >
> > 情形7: $a_{1}>0, a_{2}=0$,  1负1零两个实根, 变号次数为0, 有0个正根; 
> >
> > 情形8: $a_{1}<0, a_{2}=0$,  1正1零两个实根, 变号次数为 1, 有1个正根; 
> >
> > 情形9: $a_{1}=a_{2}=0$,  2个零根, 变号次数为 0, 有0个正根. 

> 实系数三次方程 $a_{0} x^{3}+a_{1} x^{2}+a_{2} x+a_{3}=0, a_{0} \neq 0$, 不妨设首项系数 $a_{0}>0$, 共有 27 种情形. 比二次方程更为复杂, 根据韦达定理
> $$
> x_{1}+x_{2}+x_{3}=-\frac{a_{1}}{a_{0}}, x_{1} x_{2}+x_{2} x_{3}+x_{1} x_{3}=\frac{a_{2}}{a_{0}}, x_{1} x_{2} x_{3}=-\frac{a_{3}}{a_{0}}
> $$
> 我们只能由 $a_{0}a_{3}$ 的符号判断出正根个数的奇偶性, 也正好等于变号次数的奇偶性, 但由此无法判断正根个数是否不超过变号次数. 
>
> 先考虑 2 种最特殊的情况: 变号次数为 0, 容易看出正根个数也为 0 (反之方程左边恒大于零); 而如果有 3个正根, 根据韦达定理, 系数的正负也是交替出现, 变号次数为 3. 
>
> 实系数三次方程 $f(x)=0$ 一定有1个实根, 不妨为 $r$, 可以得到 $x-r$ 是三次多项式 $f(x)$ (不妨设为首1多项式) 的一个一次因式. 因此存在二次因式 $g(x)$, 使得 $f(x)=(x-r) g(x)$
> $$
> \begin{aligned}
> f(x) &=x^{3}+a x^{2}+b x+c=(x-r)\left(x^{2}+d x+e\right) \\
> &=x^{3}+(d-r) x^{2}+(e-r d) x-r e
> \end{aligned}
> $$
> 考虑 $r>0$ 的情形:
>
> 1. $V(g)=0 \Rightarrow V(f)=1$ or 3
>
> 1.1 若 $g$ 的系数为 $(+,+,+)$, 则 $f$ 的系数为 $(+, \pm, \pm,-)$ ; 
>
> 1.2 若 $g$ 的系数为 $(+,+, 0)$, 则 $f$ 的系数为 $(+, \pm,-, 0)$ ; 
>
> 1.3 若 $g$ 的系数为 $(+, 0,+)$, 则 $f$ 的系数为 $(+,-,+,-)$ ; 
>
> 1.4 若 $g$ 的系数为 $(+, 0,0)$, 则 $f$ 的系数为 $(+,-, 0,0)$ ; 
>
> 2. $V(g)=1 \Rightarrow V(f)=2$:
>
> 2.1 若 $g$ 的系数为 $(+,+,-)$, 则 $f$ 的系数为 $(+, \pm,-,+)$ ; 
>
> 2.2 若 $g$ 的系数为 $(+,-,-)$, 则 $f$ 的系数为 $(+,-, \pm,+)$ ; 
>
> 2.3 若 $g$ 的系数为 $(+, 0,-)$, 则 $f$ 的系数为 $(+,-,-,+)$ ; 
>
> 2.4 若 $g$ 的系数为 $(+,-, 0)$, 则 $f$ 的系数为 $(+,-,+, 0)$ ; 
>
> 3. $V(g)=2 \Rightarrow V(f)=3$ :
> 
> $g$ 的系数只可能为 $(+,-,+)$, 得出 $f$ 的系数对应为 $(+,-,+,-)$.
> 再讨论 $r<0$ 或 $r=0$ 的情形, 容易验证笛卡尔符号法则对三次多项式方程成立. 
> 更关键的是, 可以看出 $V(f)$ 总比 $V(g)$ 大1或3. 

**笛卡尔符号法则的证明**: 

**第一步**: 一般地, 可以证明如下结论:
对于 $r>0$ 和任意实系数多项式 $g(x)$, 可得对于实系数多项式 $f(x)=(x-r) g(x)$ 一定有 $V(f) \geq V(g)+1$
下面给出证明. 不妨设
$$
\begin{gathered}
f(x)=a_{0} x^{n}+a_{1} x^{n-1}+\cdots+a_{n-1} x+a_{n} \\
g(x)=b_{0} x^{n-1}+b_{1} x^{n-2}+\cdots+b_{n-2} x+b_{n-1}
\end{gathered}
$$

注意这里 $f$ 和 $g$ 的 $k$ 次项系数分别为 $a_{n-k}$ 和 $b_{n-k-1}$. 系数的关系如下:
$$
a_{0}=b_{0}, a_{k}=b_{k}-r b_{k-1}, 1 \leq k \leq n-1, a_{n}=-r b_{n-1}
$$
因为 $r>0$ 前面是减号, 从 $g$ 的系数变号推 $f$ 的系数变号有一定难度. 
可以考虑反过来从 $f$ 的系数变号情况来推 $g$ 的系数变号情况:
$$
b_{0}=a_{0}, b_{k}=a_{k}+r b_{k-1}, 1 \leq k \leq n-1,0=a_{n}+r b_{n-1}
$$
可以看出,  $b_{k}$ 的符号是由 $a_{k}$ 的符号和前一项 $b_{k-1}$ 的符号共同决定的, 也就是有一个滞后项 $rb_{k-1}$, 会使得当 $a_{k}$ 变号后,  $b_{k}$ 会推迟变号甚至不变号 (可以类比为加速度和速度方向相反, 由于惯性, 速度不会立即和加速度方向相同) . 不失一般性, 可以假设 $a_{n}=-r b_{n-1}$ 不为零 (否则可以考虑提出 $x$ 的次方后剩下的多项式) . 

1. 取最大的 $s_{0}<n$ 使得 $a_{0}, a_{1}, \ldots, a_{s_{0}}$ 不变号, 可得 $b_{0}, b_{1}, \ldots, b_{s_{0}}$ 也不变号; 

2. 当 $s_{0}=n-1$ 时,  $a_{0}, a_{1}, \ldots, a_{n-1}$ 不变号, 可得 $b_{0}, b_{1} \ldots, b_{n-1}$ 不变号, 但 $a_{n}=-r b_{n-1}$ 变号, 此时论证结束,  $V(f)=1, V(g)=0, V(f)-V(g)=1$.

否则, 取最大的 $s_{1}>s_{0}, s_{1}<n$ 使得 $a_{s_{0}}, a_{s_{0}+1}, \ldots, a_{s_{1}}$ 的变号1次, 那么相应可得 $b_{s_{0}}, b_{s_{0}+1}, \ldots, b_{s_{1}}$ 至多变号1次; 下面说明理由:

根据 $s_{0}$ 的定义,  $a_{0}, a_{1}, \ldots, a_{s_{1}}$ 只在 $a_{s_{0}+1}$ 处变号, 也就是说 $a_{0}, a_{1}, \ldots, a_{s_{0}}$ 不变号(其中可能有0系数, 下面提到的同号也是广义的包含零的同号), 与 $a_{s_{0}+1}$ 异号, 而 $a_{s_{0}+1}, \ldots, a_{s_{1}}$ 不变号. 

这样 $b_{s_{0}}$ 和 $a_{s_{0}}$ 符号相同, 而之后每项都会加上与 $b_{s_{0}}$ 异号的数:

$$
\begin{aligned}
&b_{s_{0}+1}=a_{s_{0}+1}+r b_{s_{0}} \\
&b_{s_{0}+2}=a_{s_{0}+2}+r b_{s_{0}+1}=a_{s_{0}+2}+r a_{s_{0}+1}+r^{2} b_{s_{0}}
\end{aligned}
$$
一种可能是不管怎么加与之异号的数,  $b_{s_{0}+1}, \ldots, b_{s_{1}}$ (与之前的 $s_0$ 项相比) 均不会变号, 变号次数为 0 ;
另一种可能是在 $b_{s_{0}+k_{0}}, 1 \leq k_{0} \leq s_{1}-s_{0}$ 处变号, 之后因为加上的是与之同号的数, 所以之后不再变号, 变号次数为 1.

3. 当 $s_{1}=n-1$ 时, 根据上述讨论:

如果 $b_{s_{0}}, \ldots, b_{s_{1}}$ 均不变号, 变号次数为 0, 而 $a_{s_{0}}, s_{s_{0}+1} \ldots, a_{s_{1}}$ 变号次数为 1,  $V(f)-V(g)=1$

如果 $b_{s_{0}}, \ldots, b_{s_{1}}$ 只在 $b_{s_{0}+k_{0}}, 1 \leq k_{0} \leq s_{1}-s_{0}$ 处变号, 变号后最终 $b_{n-1}$ 与 $a_{n-1}$ 同号, 而 $a_{n}=-r b_{n-1}$ 变号次数加 $1, V(f)-V(g)=1$.

否则, 继续取最大 $s_{2}$ 使得 $a_{s_{1}+1}, a_{s_{1}+1}, \ldots, a_{s_{2}}$ 不变号, 根据 $s_{1}$ 的定义, 
$a_{s_{0}+1}, \ldots, a_{s_{1}}, a_{s_{1}+1}, \ldots, a_{s_{2}}$ 只在 $a_{s_{1}+1}$ 处变号, 这里分为三种情况:

3.1 在上一个序列 $b_{s_{0}+1}, \ldots, b_{s_{1}}$ 中末实现变号, 现在每次加上一个同号的数, 所以
$b_{s_{1}+1}, b_{s_{1}+2}, \ldots, b_{s_{2}}$ 不变号;  (类似于减速运动速度末减到0又开始加速)

3.2 在上一个序列 $b_{s_{0}+1}, \ldots, b_{s_{1}}$ 中变号1次, 现在每次加上一个同号的数, 
$b_{s_{1}+1}, b_{s_{1}+2}, \ldots, b_{s_{2}}$ 不变号;  (类似于减速运动减到0反向加速后加速度反向又做减速运动, 但速度末减为0后反向)

3.3 在上一个序列 $b_{s_{0}+1}, \ldots, b_{s_{1}}$ 中变号1次, 现在每次加上一个同号的数, 
$b_{s_{1}+1}, b_{s_{1}+2}, \ldots, b_{s_{2}}$ 变号1次;  (类似于减速运动减到0反向加速后加速度反向又做减速运动,  并且速度减为 0 继续同方向加速运动)

依此类推, 每个 $f$ 的变号系数序列, 对应的 $g$ 系数序列要么变号要么不变号, 如果 $f$ 的第 $j$ 个变号系数是 $a_{s_{j+1}}$, 那么同一序列对应的 $g$ 的变号系数 $b_{t_{j+1}}$ 一定有 $t_{j+1} \geq s_{j+1}$.

除去常数项 $f$ 的系数变号次数一定大于等于对应的 $g$ 的系数变号次数;  $f$ 的最后一个变号系数序列对应的 $g$ 的系数序列要么实现了变号, 最后一个 $a_{n}=-r b_{n-1}$ 表明 $f$ 的变号次数比 $g$ 多 1, 要么 $g$ 没有实现变号, 仍然表明 $f$ 的变号次数比 $g$ 多1; 总的来说就是 $V(f)-V(g) \geq 1$.

如果 $f(x)=0$ 有 $p$ 个正根, 则 $f(x)=\left(x-r_{1}\right)\left(x-r_{2}\right) \cdots\left(x-r_{p}\right) g(x)$. 重复利用上述结论可知,  $V(f)-V(g) \geq p$, 也就是 $p \leq V(f),  f(x)=0$ 的正根个数一定不超过其系数变号次数 $V(f)$.

**第二步**: 现在证明 $f(x)=0$ 的正根个数 $p$ 是 $V(f)$ 减去一个非负偶数. 

同样不妨假设 $a_{n} \neq 0$, 否则考虑提出 $x$ 的某个次方, 化归为常数项非零的多项式. 

由韦达定理可知, 所有 $n$ 个根的乘积为 $(-1)^{n} \frac{a_{n}}{a_{0}}$. 共轭虚根成对出现, 假设有 $t$ 对, 共轭虚根乘积一定是正数, 正根之积也是正数, 有 $p$ 个正根, 那么负根的数量为 $n-p-2 t$, 那么所有根乘积的符号为 $(-1)^{n-p-2 t}=(-1)^{n-p}$, 这说明 $(-1)^{n-p}$ 和 $(-1)^{n} a_{0} a_{n}$ 符号相同, 也就是如果 $a_{0} a_{n}>0$ 那么 $p$ 为偶数, 如果 $a_{0} a_{n}<0$ 那么 $p$ 为奇数. 注意到 $a_{0} a_{n}>0$, 变号次数一定为偶数,  $a_{0} a_{n}<0$, 变号次数一定为奇数, 这就得到 $p$ 的奇偶性和 $V(f)$ 相同,  结合 $p \leq V(f)$ 可得结论 $p$ 一定是 $V(f)$ 减去一个非负偶数. 

> 推论: 对于实系数多项式方程 $f(x)=0$, 其负根的个数等于 $f(-x)$ 的变号次数减去一个非负偶数. 

如果对实系数多项式方程 $f(x)=0$ 作替换 $f(x+a)$ 用笛卡尔符号法则, 可以知道 $f(x)=0$ 在 $x>a$ 上的实根个数的可能值, 作替换 $f(b-x)$ 用笛卡尔符号法则, 可以知道 $f(x)=0$ 在 $x<b$ 上的实根个数的可能值. 更精确的定理是斯图姆定理(Sturm's theorem), 可以判断实系数多项式方程在任何左开右闭区间 $(a, b]$ 上的不同实根个数.

[^1]: https://zhuanlan.zhihu.com/p/161577971

# 笛卡尔符号法则的归纳法证明[^2]

设$f(x)=a_{n}x^{n}+a_{n-1}x^{n-1}+\cdots+a_{0}$, 其中$a_{j}\in\mathbb{R}$. 设$s_{n}$为序列$\left(a_{n},a_{n-1},\cdots,a_{0}\right)$的变号次数, (这里认为$0$与任何数字同号). 设$p_{n}$为函数$f(x)$的正实根数, (计重数). 则对于任意的$n\in\mathbb{Z}_{>0}$: $s_{n}-p_{n}$为非负偶数. 

证明: 归纳假设, 当$n=1$时, 结论是容易的分类讨论验证的.

假设命题对于$n$成立, 现在证明命题对于$n+1$也成立. 证明需要用到以下结论:

> 当$a_{0}$, $a_{n}$同号时, 考虑$f(0)$与$f(+\infty)$的有相同的符号, 所以函数$f(x)$的正根的个数必然是偶数, 且变号次数也为偶数.

设$n+1$时的命题, 函数有表达式
$$
f(x)=a_{n+1}x^{n+1}+a_{n}x^{n}+a_{n-1}x^{n-1}+\cdots+a_{1}x+a_{0}.
$$

分两种情况进行归纳证明, 

1) $s_{n}$和$p_{n}$都为偶数, $a_{n}$与$a_{0}$同号: 有四种子情况:

A). $a_{n},a_{0}>0$, $a_{n+1}>0$, 这时根据前面的结论, $s_{n+1}=s_{n}$是偶的, $a_{n+1}$, $a_{0}$同号, $p_{n+1}$也是偶的.

B). $a_{n},a_{0}>0$, $a_{n+1}<0$, 这时$s_{n+1}=s_{n}+1$是奇数, $a_{n+1},a_{0}$异号, $p_{n+1}$是奇数.

C). $a_{n},a_{0}<0$, $a_{n+1}>0$, 这时$s_{n+1}=s_{n}+1$是奇数, $a_{n+1},a_{0}$异号, $p_{n+1}$是奇数.

D). $a_{n},a_{0}<0$, $a_{n+1}<0$, 这时$s_{n+1}=s_{n}$是偶数, $a_{n+1}$, $a_{0}$同号, $p_{n+1}$也是偶的.

2) $s_{n}$和$p_{n}$都是奇数, 这时$a_{n}$和$a_{0}$异号, 也有四种子情况:

A). $a_{n}>0$, $a_{0}<0$, $a_{n+1}>0$, 这时$s_{n+1}=s_{n}$是奇数, $a_{n+1}$和$a_{0}$异号, $p_{n+1}$也是奇数.

B). $a_{n}>0$, $a_{0}<0$, $a_{n+1}<0$, 这时$s_{n+1}=s_{n}+1$是偶数, $a_{n+1}$和$a_{0}$同号, $p_{n+1}$也是偶数.

C). $a_{n}<0$, $a_{0}>0$, $a_{n+1}>0$, 这时$s_{n+1}=s_{n}+1$是偶数, $a_{n+1}$和$a_{0}$同号, $p_{n+1}$也是偶数.

D). $a_{n}<0$, $a_{0}>0$, $a_{n+1}<0$, 这时$s_{n+1}=s_{n}$是奇数, $a_{n+1}$和$a_{0}$异号, $p_{n+1}$也是奇数.

以上任何一种情况皆说明$s_{n+1}-p_{n+1}$是偶数. 

以上证明需要注意的是, 当$a_{n}=0$时, 可以考虑系数非零的低阶幂作为归纳起点, 上面的论证过程仍然合理. 也就是假设命题对于多项式指数$\le n$时成立, 去证明多项式指数为$n+1$时, 命题仍然成立. 此时讨论的系数是$a_{n+1}$, $a_{n-k}$, $a_{0}$之间的符号变化, 其中$a_{n}=a_{n-1}=\cdots=a_{n-k+1}=0$.

下面证明对于任意的$n\in\mathbb{Z}_{>0}$时, 总有$s_{n}\ge p_{n}$.

考虑$f'(x)$, 它是$n-1$阶多项式, 符号变化次数为$s'$, 正实根数为$p'$, 则有$s_{n}\ge s'$, $p'=p_{n}-1$. 再由归纳法, $s'\ge p'$, 所以

$$
s_{n}\ge s'\ge p'\ge p_{n}-1
$$

所以$s_{n}-p_{n}\ge-1$, 最后由于已征得$s_{n}-p_{n}$是偶数, 所以$s_{n}\ge p_{n}$.

[^2]: https://proofwiki.org/wiki/Descartes%27_Rule_of_Signs
